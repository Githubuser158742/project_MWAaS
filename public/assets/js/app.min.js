var app={page:"all",activeTab:null,reload:null};$(function(){function e(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return a[e]})}app.loadJSON=function(){var e=new Request("http://localhost:3000/assets/data/recipes.json",{method:"GET",mode:"cors",redirect:"follow",cache:"no-cache",headers:new Headers({"Content-Type":"application/json"})});fetch(e).then(function(e){return e.ok?e.json():(app.loadData(),void(1==app.reload&&(alert("Er kon geen verbinding gemaakt worden met de database!"),app.reload=0)))}).then(function(e){app.updateDB(e),1==app.reload&&(alert("Database updated!"),app.reload=0)})["catch"](function(e){app.loadData(),1==app.reload&&(alert("Er kon geen data weggeschreven worden!"),app.reload=0)})},app.updateDB=function(e){var a=localforage.createInstance({name:"recipe_store"}),i=e.recipes,t={},p=[];i.forEach(function(e){t={},t.id=e.id,t.description=e.description,t.chef=e.chef,t.category=e.category,t.added=e.added,t.steps=e.steps,p.push(t)}),a.setItem("recipes",JSON.stringify(p)),app.loadData()},app.updateCustomDB=function(e){var a=localforage.createInstance({name:"recipe_store"});a.setItem("customvalues",JSON.stringify(app.customvalues))},app.loadData=function(){var e=localforage.createInstance({name:"recipe_store"});e.getItem("recipes").then(function(a){app.recipes=JSON.parse(a),e.getItem("customvalues").then(function(e){app.customvalues=[],null!==JSON.parse(e)&&void 0!==JSON.parse(e)&&$.each(JSON.parse(e),function(e,a){null!==a&&void 0!==a&&(app.customvalues[a.recipe_id]=a)}),app.showData()})})},app.showData=function(){switch($("#pageone").is(".ui.page-active")&&(app.page="all"),$("#pagetwo").is(".ui-page-active")&&(app.page="saved"),$("#pagethree").is(".ui-page-active")&&(app.page="rated"),app.page){case"all":$("#btnOne").trigger("buildpage");break;case"saved":$("#btnTwo").trigger("buildpage");break;case"rated":$("#btnThree").trigger("buildpage")}},app.sortById=function(e,a){var i=parseInt(e.id),t=parseInt(a.id);return t>i?-1:i>t?1:0},app.showRecipes=function(a){var i=null;switch(a){case 1:i=app.activeTab;break;case 2:i=app.activeTab+"Saved";break;case 3:i=app.activeTab+"Rated";break;default:i=app.activeTab}$("#"+i).html("");var t=1;switch(app.activeTab){case"meat":app.recipes.sort(app.sortById);break;case"fish":app.recipes.sort(app.sortById);break;case"veggie":app.recipes.sort(app.sortById)}if(null==app.recipes){var p="Gelieve een categorie te kiezen.";$("#"+i).append(p)}$.each(app.recipes,function(p,c){var o=!1,s=!1,n=!1,l="",r="";c.category==app.activeTab&&(1==a&&(o=!0,null!==app.customvalues[c.id]&&void 0!==app.customvalues[c.id]&&1==app.customvalues[c.id].saved&&(o=!1)),null!==app.customvalues[c.id]&&void 0!==app.customvalues[c.id]&&(null!==app.customvalues[c.id].score&&(l=e(app.customvalues[c.id].score)),null!==app.customvalues[c.id].comment&&(r=e(app.customvalues[c.id].comment)),null!==app.customvalues[c.id].saved&&2==a?s=!0:null===app.customvalues[c.id].saved||3!=a||""===l&&""===r||(n=!0)));var d=e(c.id.toString()),u=e(c.description.toString()),v=e(c.chef.toString()),g=e(c.added.toString()),b=e(c.steps.toString());if(o){var m=["<div class='ui-bar ui-bar-b'>","<div class='ui-grid-a'><center>","<input class='checkboxrecipe' id='checkBox"+d+"' data-recipe='"+d+"' type='checkbox'>"+u+"</center></div>","<div class='ui-grid-a'>","<div class='ui-block-a'><center>"+v+"</center></div>","<div class='ui-block-b'><center>"+g+"</center></div>","</div>","<center><div data-role='collapsible' id='"+i+"' class='ui-collapsible ui-collapsible-inset ui-corner-all ui-collapsible-themed-content'>","<h4 class='ui-collapsible-heading'>Stappenplan</h4>","<p>"+b+"</p>","</center></div>","</div>"].join(" ");$("#"+i).append(m),$("#"+i).trigger("create")}if(s){var m=["<div class='ui-bar ui-bar-b'>","<div class='ui-grid-a'>","<center>"+u+"</center>","</div>","<div class='ui-grid-a'>","<div class='ui-block-a'>","<center>"+v+"</center>","</div>","<div class='ui-block-b'>","<center>"+g+"</center>","</div>","</div>","<div data-role='collapsible' id='"+i+"' class='ui-collapsible ui-collapsible-inset ui-corner-all ui-collapsible-themed-content'>","<h4 class='ui-collapsible-heading'>Stappenplan</h4>","<p>"+b+"</p>","</div>","<div data-role='fieldcontain'>","<div class='ui-grid-a'>","<div class='ui-block-a'>","<label for='scorerecipe' class='select'>Score op 10:</label>","<select class='scorerecipe' id='"+app.activeTab+"scorerecipe"+c.id.toString()+"' data-recipe='"+c.id.toString()+"'>","<option value=''"+(""==l.toString()?"selected":"")+">--</option>","<option value='10'"+("10"==l.toString()?"selected":"")+">10</option>","<option value='8'"+("8"==l.toString()?"selected":"")+">8</option>","<option value='7'"+("7"==l.toString()?"selected":"")+">7</option>","<option value='6'"+("6"==l.toString()?"selected":"")+">6</option>","<option value='5'"+("5"==l.toString()?"selected":"")+">5</option>","<option value='4'"+("4"==l.toString()?"selected":"")+">4</option>","<option value='3'"+("3"==l.toString()?"selected":"")+">3</option>","<option value='2'"+("2"==l.toString()?"selected":"")+">2</option>","<option value='1'"+("1"==l.toString()?"selected":"")+">1</option>","<option value='0'"+("0"==l.toString()?"selected":"")+">0</option>","</select>","</div>","<div class='ui-block-b'>","<label for='commentrecipe' class='input'>Opmerking:</label>","<textarea class='commentrecipe' id='"+app.activeTab+"commentrecipe"+c.id.toString()+"' data-recipe='"+c.id.toString()+"' maxlength='150' rows='2'>"+r.toString()+"</textarea>","</div>","</div>","</div>","<div>"].join(" ");$("#"+i).append(m),$("#"+i).trigger("create"),t++}if(n){var m=["<div class='ui-bar ui-bar-b'>","<div class='ui-grid-a'>",u,"</div>","<div class='ui-grid-a'>","<div class='ui-block-a'>",v,"</div>","<div class='ui-block-b'>",g,"</div>","</div>","<div class='ui-grid-a'>","<div class='ui-block-a'>","Score: "+l.toString(),"</div>","<div class='ui-block-b'>","Commentaar: "+r.toString(),"</div>","</div>","<div data-role='collapsible' id='"+i+"' class='ui-collapsible ui-collapsible-inset ui-corner-all ui-collapsible-themed-content'>","<h4 class='ui-collapsible-heading'>Stappenplan</h4>","<p>"+b+"</p>","</div>","</div>"].join(" ");$("#"+i).append(m),$("#"+i).trigger("create")}})},$("#btnOne").on("click buildpage",function(e){app.activeTab="meat",$("#pageMeat").addClass("ui-btn-active"),app.showRecipes(1)}),$("#pageMeat").on("click",function(e){app.activeTab="meat",app.showRecipes(1)}),$("#pageFish").on("click",function(e){app.activeTab="fish",app.showRecipes(1)}),$("#pageVeggie").on("click",function(e){app.activeTab="veggie",app.showRecipes(1)}),$(document).on("change",function(e){var a=$("#"+e.target.id+":checkbox:checked").length>0,i=parseInt($("#"+e.target.id).data("recipe"));i&&null!==a&&void 0!==a&&(null===app.customvalues[i]||void 0===app.customvalues[i]?app.customvalues[i]={recipe_id:i,saved:a,score:null,comment:null}:app.customvalues[i].saved=a,alert("Het recept is opgeslagen!"),app.updateCustomDB())}),$(document).on("change",function(e){var a=$("#"+e.target.id+" option:selected").val(),i=parseInt($("#"+e.target.id).data("recipe"));i&&null!==a&&void 0!==a&&(null===app.customvalues[i]||void 0===app.customvalues[i]?app.customvalues[i]={recipe_id:i,score:a,comment:null}:app.customvalues[i].score=a,app.updateCustomDB())}),$(document).on("keyup",function(a){var i=$("#"+a.target.id).val();i=e(i);var t=parseInt($("#"+a.target.id).data("recipe"));null!==t&&void 0!==t&&NaN!==t&&null!==i&&void 0!==i&&(null===app.customvalues[t]||void 0===app.customvalues[t]?app.customvalues[t]={recipe_id:t,score:null,comment:i}:app.customvalues[t].comment=i,app.updateCustomDB())}),$("#btnTwo").on("click buildpage",function(e){app.page="saved",app.activeTab="meat",$("#pageMeatSaved").addClass("ui-btn-active"),app.showRecipes(2)}),$("#pageMeatSaved").on("click",function(e){app.activeTab="meat",app.showRecipes(2)}),$("#pageFishSaved").on("click",function(e){app.activeTab="fish",app.showRecipes(2)}),$("#pageVeggieSaved").on("click",function(e){app.activeTab="veggie",app.showRecipes(2)}),$("#btnThree").on("click buildpage",function(e){app.page="rated",app.activeTab="meat",$("#pageMeatRated").addClass("ui-btn-active"),app.showRecipes(3)}),$("#pageMeatRated").on("click",function(e){app.activeTab="meat",app.showRecipes(3)}),$("#pageFishRated").on("click",function(e){app.activeTab="fish",app.showRecipes(3)}),$("#pageVeggieRated").on("click",function(e){app.activeTab="veggie",app.showRecipes(3)}),$("#btnRefresh").on("click",function(e){location.reload()}),$("#btnRefresh2").on("click",function(e){location.reload()}),$("#btnRefresh3").on("click",function(e){location.reload()}),"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(){});var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};app.loadJSON()});
